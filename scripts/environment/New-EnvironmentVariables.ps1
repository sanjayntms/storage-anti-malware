#!/usr/bin/env pwsh

# Set the subscription ID to a task variable
$id = (az account show | ConvertFrom-Json).id;
Write-Output "##vso[task.setvariable variable=subscriptionId]$id"

# Get the object ID of the Service Connection SPN
$servicePrincipalObjectId = (az ad sp list --spn $env:servicePrincipalId | ConvertFrom-Json)[0].objectId

Write-Output "##vso[task.setvariable variable=servicePrincipalObjectId]$servicePrincipalObjectId"
